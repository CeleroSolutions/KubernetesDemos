# Deploy Load Generator to AKS

Follow these steps to deploy the Load Generator to AKS.

## Step 1: Add application in ArgoCD

From the ArgoCD homepage (see [step 2](./2%20-%20Connect%20to%20AKS%20and%20Install%20ArgoCD.md) for directions), select *Create Application*:

![ArgoCD Create Application](Resources/ArgoCdCreateApplication.png)

Fill in the following sections and click *Create*. Leave all other sections blank:


**General Settings:**

- Application Name:   load-generator
- Project Name:       default
- Sync Policy:        Automatic
- Prune Resources:    Checked
- Self Heal:          Checked

![ArgoCD Create Application General Settings](Resources/ArgoCdCreateApplicationGeneralSettings.png)


**Source Settings:**

- Repository URL:     https://github.com/CeleroSolutions/KubernetesIntro.git
- Path:               Infrastructure/KubernetesServices/LoadGenerator

![ArgoCD Create Application Source Settings](Resources/ArgoCdCreateApplicationSourceSettings.png)


**Destination Settings:**

- Cluster URL:        https://kubernetes.default.svc
- Namespace:          argocd

![ArgoCD Create Application Destination Settings](Resources/ArgoCdCreateApplicationDestinationSettings.png)


You should see the application created on the ArgoCD home page:

![ArgoCD Create Application Progressing](Resources/ArgoCdCreateApplicationProgressing.png)


 Click on the application and you should see resources being created and eventually change to healthy:

 ![ArgoCD Application Progressing](Resources/ArgoCdApplicationProgressing.png)

  ![ArgoCD Application Success](Resources/ArgoCdApplicationSuccess.png)


  ## Step 2: Connect to Load Generator

  Click on the Service in the application page: 
  
  ![ArgoCD Application Service](Resources/ArgoCdApplicationService.png)
  
  Record the public IP address:

  ![ArgoCD Application Service IP Address](Resources/ArgoCdApplicationServiceIpAddress.png)

  Browse to *http://<ipAddress>/swagger* and confirm you see the following page:

  ![Prime Calculator Demo Swagger](Resources/PrimeCalculatorDemoSwagger.png)

Load can be generated by repeatedly calling *http://<ipAddress>/findPrime* with a tool like [Apache JMeter](https://jmeter.apache.org/)